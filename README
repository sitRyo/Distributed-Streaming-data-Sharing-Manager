Network Streaming data Sharing Manager Readme

* 概要
Network Streaming data Sharing Manager(以降DSSM) は Streaming data Sharing Manager(以降SSM) にネットワークを介した共有メモリへのアクセス機能を追加したものです.
SSMで構成されたシステムのプログラムを殆ど変更せずにネットワーク対応にすることを目標に開発しています.
そのため, 基本的な使い方はSSMと同じですが, ネットワークを使用する関係上, ユーザプログラムに変更が必要な箇所が多々存在します.
それに関してはutilityディレクトリ内のread_proxy_sample.cppとwrite_proxy_sample.cppをご覧ください. 

* ディレクトリ構成
Network_Streaming_data_Sharing_Manager - 
 - Makefile   Make ファイル
 - README_nssm.ja nssmのREADME
 - src        ソースファイル
 - include    インクルードファイル
 - utilities  SSMとDSSMのユーティリティのソースコード

* インストール
 $ ./configure
 $ make

(/usr/local/bin以下にインストールしたい場合)
 $ sudo make install

(/usr/local/bin以下にインストールしない場合)
最初に, NSSM管理用のディレクトリを作成します(名前は何でも良いです).
作成したディレクトリにダウンロードしたNSSMを移動します.

その後Network Streaming data Sharing Manager内のスクリプト(setup.sh)を実行します.
$ bash setup.sh

次に実行するmakeファイルに以下のリンクを加えてください
${Network_Streaming_data_Sharing_Managerまでの絶対パス}/include
${Network_Streaming_data_Sharing_Managerまでの絶対パス}/src/.libs

* cmakeの場合, CMakeLists.txtのadd_executable命令の前に以下の命令を加えてください
link_directories(${Network_Streaming_data_Sharing_Managerまでの絶対パス}/src/.libs)
include_directories(${Network_Streaming_data_Sharing_Managerまでの絶対パス}/include)

makeファイルを変更後, もう1度 make を実行することでNSSMでプログラムが動作するようになります.

注1 ) Autotoolsがない場合
 $ apt-get install automake libtool
で必要なパッケージをインストールしてください

注2 ) コンパイラがc++11に対応していない場合
gcc-5 より以前のバージョンだと, コンパイルが正常にできない現象を確認しています.
その際は, gcc-8をインストールしてコンパイルしてください.

注3 )

setup.shを実行すると, build2というディレクトリが生成され, 以下のようなディレクトリ構成になります

|
|- Network Streaming data Sharing Manager
|- build2

そのため, 新たなディレクトリを作成してその中でNSSM関連のディレクトリをまとめることをおすすめしています.
(つまり以下のようなディレクトリ構造です.)

- projects
  |
  |- Network Streaming data Sharing Manager
  |- build2

なお, このスクリプトはプログラムが参照するSSMのライブラリをNSSM内のライブラリに変更しています.

* プログラム
- SSM
 - ssm-coordinator     Sensor Shairing Manager
 - lsssm               登録されているセンサ情報のリスト表示
 - ssm-logger          ログ取り
 - ssm-advance-player  ログ再生
 - ssm-monitor         書き込み状況表示
 - ssm-graph           ssmの接続状態のdotファイル吐き出し
 - ssm-transporter     ２台のPCでのSSMの同期
 - ssm-date            SSM時刻管理

- DSSM
 - ssm-proxy           coordinatorにネットワークを介して受け取ったデータを渡す
 - ssm-proxy-client    センサハンドラのデータをproxyに送信する

* 起動方法
1, src/ssm-coordinatorを起動
2, utility/ssm-proxyを起動
3, ユーザプログラムを起動

* サンプルプログラム
DSSMのサンプルは utility/read_proxy_sample と utility/write_proxy_sample です.

* トラブルシューティング
1. autotool関連のエラーがでる
 $ autoreconf -i -f
を実行すると治るかもしれません.

--install（-i）
パッケージ化に足りないファイルを自動的に生成。
--force（-f）
既存のファイルを置き換える。デフォルトでは既存のファイルを上書きしない。

2. リンカがエラーを吐く
32bitOSを使用しているときは, utility/Makefile.amのAM_CFLAGSに-L/lib64 -lpthreadを追加してください.

3. メッセージをcoordinatorに送ろうとするとメモリ二重解放エラーが出る
branchを32-64bitに切り替えて, 再度makeして実行してください.
masterブランチは同じbitのOS間での通信にしか対応していません.